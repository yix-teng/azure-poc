{
	"name": "Round_1_Serveless_create_external_views_3TB",
	"properties": {
		"content": {
			"query": "-- will need changes to point this to the correct ADLS folder path\n\n\nIF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseParquetFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat] \n\tWITH ( FORMAT_TYPE = PARQUET)\nGO\n\nCREATE MASTER KEY ENCRYPTION BY PASSWORD='StoragePassword@123';\n\nalter database benchmark SET QUERY_STORE = ON;\n\nCREATE DATABASE SCOPED CREDENTIAL [sqlondemand]\nWITH IDENTITY='SHARED ACCESS SIGNATURE',  \nSECRET = 'sv=2020-08-04&ss=bfqt&srt=sco&sp=rwdlacupx&se=2021-09-30T20:28:42Z&st=2021-08-29T12:28:42Z&spr=https&sig=tp510hNvWZYC0bnnGZOrJRHZSOyWvGpLZBb%2BfBsWP88%3D'\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'tpcdata_scbpocdev_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [tpcdata_scbpocdev_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION   = 'https://scbpocdev.dfs.core.windows.net/dbstorage3000', \n   \t\tCREDENTIAL = sqlondemand\n   \t)\nGo\n\nCREATE View call_center as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/call_center/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View catalog_page as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/catalog_page/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View catalog_returns as select *, cr.filepath(1) as cr_returned_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/catalog_returns/cr_returned_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View catalog_sales as select *, cr.filepath(1) as cs_sold_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/catalog_sales/cs_sold_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View customer as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/customer/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View customer_address as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/customer_address/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View customer_demographics as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/customer_demographics/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View date_dim as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/date_dim/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View household_demographics as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/household_demographics/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View income_band as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/income_band/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View inventory as select *, cr.filepath(1) as inv_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/inventory/inv_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View item as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/item/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View promotion as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/promotion/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View reason as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/reason/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View ship_mode as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/ship_mode/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View store as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/store/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View store_returns as select *, cr.filepath(1) as sr_returned_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/store_returns/sr_returned_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View store_sales as select *, cr.filepath(1) as ss_sold_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/store_sales/ss_sold_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View time_dim as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/time_dim/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View warehouse as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/warehouse/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View web_page as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/web_page/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\nCREATE View web_returns as select *, cr.filepath(1) as wr_returned_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/web_returns/wr_returned_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View web_sales as select *, cr.filepath(1) as ws_sold_date_sk from  OPENROWSET ( BULK 'TPC-DS/SourceFiles_parquet/web_sales/ws_sold_date_sk=*/*.parquet', DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net', FORMAT = 'PARQUET' ) as cr\nGO\nCREATE View web_site as select * from OPENROWSET (BULK 'TPC-DS/SourceFiles_parquet/web_site/*.parquet',DATA_SOURCE = 'tpcdata_scbpocdev_dfs_core_windows_net',FORMAT = 'PARQUET') as cr\nGO\n\n\nselect count(*) from call_center\nselect count(*) from catalog_page\nselect count(*) from catalog_returns\nselect count(*) from catalog_sales\nselect count(*) from customer\nselect count(*) from customer_address\nselect count(*) from customer_demographics\nselect count(*) from date_dim\nselect count(*) from household_demographics\nselect count(*) from income_band\nselect count(*) from inventory\nselect count(*) from item\nselect count(*) from promotion\nselect count(*) from reason\nselect count(*) from ship_mode\nselect count(*) from store\nselect count(*) from store_returns\nselect count(*) from store_sales\nselect count(*) from time_dim\nselect count(*) from warehouse\nselect count(*) from web_page\nselect count(*) from web_returns\nselect count(*) from web_sales\nselect count(*) from web_site\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "Round_1_Serveless_create_external_views_3TB_DB",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}